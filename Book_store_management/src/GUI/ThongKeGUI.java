/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package GUI;

import BUS.ThongKeBUS;
import DTO.ThongKe.ThongKeDoanhThuDTO;
import DTO.ThongKe.ThongKeSanPhamBanDTO;
import DTO.ThongKe.ThongKeTheLoaiBanDTO;
import ExportFile.PdfExporter;
import GUI.Component.Chart.BarChart.Chart;
import GUI.Component.Chart.BarChart.ModelChart;
import Util.sharedFunction;
import com.sun.jdi.IntegerType;
import com.toedter.calendar.JDateChooser;
import java.awt.Color;
import java.text.SimpleDateFormat;
import java.time.LocalDate;
import java.time.ZoneId;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Collections;
import java.util.Date;
import java.util.List;
import java.util.Set;
import javax.swing.JComboBox;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author NGOC THUC
 */
public final class ThongKeGUI extends javax.swing.JPanel {

    /**
     * Creates new form ThongKeGUI
     */
    private ThongKeBUS tkBUS = new ThongKeBUS();
    Chart chart;

    public ThongKeGUI() {
        initComponents();
        setDefaultValues(spngaybatdau, spngayketthuc, CbThoiGianSanPham);
        setDefaultValues(tlngaybatdau, tlngayketthuc, CbThoiGianTheLoai);
        populateComboBoxALL();
        thongKeDoanhThuTuNamDenNam();
        thongKeDoanhThuTheoThangTrongNam();
        ThongKeDoanhThuTungNgayTrongThang();
        ThongKeDoanhThuTuNgayDenNgay();
        thongKeSanPhamBanTrongKhoangThoiGian();
        thongKeSanPhamBanTrongKhoangThoiGian();
        formatTable();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel5 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel2 = new javax.swing.JPanel();
        jTabbedPanel = new javax.swing.JTabbedPane();
        ThongKeTheoNam = new javax.swing.JPanel();
        PanelThongKeTheoNam = new javax.swing.JPanel();
        cbNamKetThuc = new javax.swing.JComboBox<>();
        cbNamBatDau = new javax.swing.JComboBox<>();
        btnInPDF = new Components.ButtonRadius();
        btnXuatExcel = new Components.ButtonRadius();
        jScrollPane1 = new javax.swing.JScrollPane();
        tableTheoNam = new javax.swing.JTable();
        lblNamBatDau = new javax.swing.JLabel();
        lblNamKetThuc = new javax.swing.JLabel();
        jPanelChartNam = new javax.swing.JPanel();
        ThongKeTheoThangTrongNam = new javax.swing.JPanel();
        PanelThongKeTheoThang = new javax.swing.JPanel();
        cbNam = new javax.swing.JComboBox<>();
        jScrollPane2 = new javax.swing.JScrollPane();
        tableTheoThang = new javax.swing.JTable();
        lblNam = new javax.swing.JLabel();
        btnThem = new Components.ButtonRadius();
        btnThem1 = new Components.ButtonRadius();
        btnThem2 = new Components.ButtonRadius();
        jPanelChartThang = new javax.swing.JPanel();
        ThongKeTheoNgayTrongThang = new javax.swing.JPanel();
        PanelThongKeTheoThang1 = new javax.swing.JPanel();
        jScrollPane6 = new javax.swing.JScrollPane();
        tableTheoTungNgayTrongThang = new javax.swing.JTable();
        lblNam1 = new javax.swing.JLabel();
        cbThang = new javax.swing.JComboBox<>();
        lblNamKetThuc2 = new javax.swing.JLabel();
        btnThem3 = new Components.ButtonRadius();
        btnThongKe1 = new Components.ButtonRadius();
        btnThem5 = new Components.ButtonRadius();
        cbNam1 = new javax.swing.JComboBox<>();
        jPanelChartNgay = new javax.swing.JPanel();
        ThongKeTuNgayDenNgay = new javax.swing.JPanel();
        PanelThongKeTheoThang2 = new javax.swing.JPanel();
        jScrollPane7 = new javax.swing.JScrollPane();
        TableTuNgayDenNgay = new javax.swing.JTable();
        lblNam2 = new javax.swing.JLabel();
        btnThem6 = new Components.ButtonRadius();
        btnThem7 = new Components.ButtonRadius();
        btnThem8 = new Components.ButtonRadius();
        NgayBatDau = new com.toedter.calendar.JDateChooser();
        NgayKetThuc = new com.toedter.calendar.JDateChooser();
        lblNam3 = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        jTabbedPaneTheLoai = new javax.swing.JTabbedPane();
        jPanel7 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        TableSanPham = new javax.swing.JTable();
        CbThoiGianSanPham = new javax.swing.JComboBox<>();
        lblThoiGian = new javax.swing.JLabel();
        CbTieuChi = new javax.swing.JComboBox<>();
        btnThem13 = new Components.ButtonRadius();
        btnThem14 = new Components.ButtonRadius();
        spngayketthuc = new com.toedter.calendar.JDateChooser();
        spngaybatdau = new com.toedter.calendar.JDateChooser();
        jPanelChartSanPhamBan = new javax.swing.JPanel();
        cbTopSanPham = new javax.swing.JComboBox<>();
        jPanel12 = new javax.swing.JPanel();
        jScrollPane9 = new javax.swing.JScrollPane();
        TableTheLoai = new javax.swing.JTable();
        CbThoiGianTheLoai = new javax.swing.JComboBox<>();
        lblThoiGian2 = new javax.swing.JLabel();
        CbTieuChiTheLoai = new javax.swing.JComboBox<>();
        btnThem18 = new Components.ButtonRadius();
        btnThem19 = new Components.ButtonRadius();
        tlngayketthuc = new com.toedter.calendar.JDateChooser();
        tlngaybatdau = new com.toedter.calendar.JDateChooser();
        jPanelChartTheLoai = new javax.swing.JPanel();
        cbTopTheLoai = new javax.swing.JComboBox<>();
        jPanel9 = new javax.swing.JPanel();
        jScrollPane4 = new javax.swing.JScrollPane();
        TableThoiGian = new javax.swing.JTable();
        jPanel4 = new javax.swing.JPanel();
        jPanel3 = new javax.swing.JPanel();
        jPanel6 = new javax.swing.JPanel();

        setMaximumSize(new java.awt.Dimension(1020, 750));
        setPreferredSize(new java.awt.Dimension(1020, 750));

        jPanel5.setBackground(new java.awt.Color(255, 255, 255));
        jPanel5.setMaximumSize(new java.awt.Dimension(1020, 750));
        jPanel5.setMinimumSize(new java.awt.Dimension(1020, 750));
        jPanel5.setPreferredSize(new java.awt.Dimension(1020, 750));

        jLabel6.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 18)); // NOI18N
        jLabel6.setForeground(new java.awt.Color(253, 183, 58));
        jLabel6.setText("Thống kê");

        jLabel5.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 18)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(253, 183, 58));
        jLabel5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_40px/dashboard_1.png"))); // NOI18N

        jTabbedPane1.setBackground(new java.awt.Color(255, 255, 255));
        jTabbedPane1.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jTabbedPane1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTabbedPane1MouseClicked(evt);
            }
        });

        jTabbedPanel.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTabbedPanelMouseClicked(evt);
            }
        });

        ThongKeTheoNam.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ThongKeTheoNamMouseClicked(evt);
            }
        });

        cbNamKetThuc.setToolTipText("");
        cbNamKetThuc.setBorder(null);
        cbNamKetThuc.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbNamKetThucItemStateChanged(evt);
            }
        });
        cbNamKetThuc.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbNamKetThucActionPerformed(evt);
            }
        });

        cbNamBatDau.setBorder(null);
        cbNamBatDau.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbNamBatDauItemStateChanged(evt);
            }
        });
        cbNamBatDau.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbNamBatDauActionPerformed(evt);
            }
        });

        btnInPDF.setBorder(null);
        btnInPDF.setForeground(new java.awt.Color(135, 172, 217));
        btnInPDF.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/back.png"))); // NOI18N
        btnInPDF.setText("In PDF");
        btnInPDF.setFocusPainted(false);
        btnInPDF.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnInPDF.setIconTextGap(0);
        btnInPDF.setMargin(new java.awt.Insets(0, 0, 0, 0));
        btnInPDF.setMaximumSize(new java.awt.Dimension(100, 40));
        btnInPDF.setPreferredSize(new java.awt.Dimension(100, 40));
        btnInPDF.setRadius(40);
        btnInPDF.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnInPDFActionPerformed(evt);
            }
        });

        btnXuatExcel.setBorder(null);
        btnXuatExcel.setForeground(new java.awt.Color(135, 172, 217));
        btnXuatExcel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/back.png"))); // NOI18N
        btnXuatExcel.setText("Xuất Excel");
        btnXuatExcel.setFocusPainted(false);
        btnXuatExcel.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnXuatExcel.setIconTextGap(0);
        btnXuatExcel.setMargin(new java.awt.Insets(0, 0, 0, 0));
        btnXuatExcel.setMaximumSize(new java.awt.Dimension(100, 40));
        btnXuatExcel.setPreferredSize(new java.awt.Dimension(100, 40));
        btnXuatExcel.setRadius(40);
        btnXuatExcel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXuatExcelActionPerformed(evt);
            }
        });

        tableTheoNam.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Năm", "Vốn ", "Doanh thu", "Lợi nhuận"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        tableTheoNam.setEnabled(false);
        tableTheoNam.setFocusable(false);
        jScrollPane1.setViewportView(tableTheoNam);

        lblNamBatDau.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNamBatDau.setForeground(new java.awt.Color(135, 172, 217));
        lblNamBatDau.setText("Từ năm");

        lblNamKetThuc.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNamKetThuc.setForeground(new java.awt.Color(135, 172, 217));
        lblNamKetThuc.setText("Đến năm");

        javax.swing.GroupLayout PanelThongKeTheoNamLayout = new javax.swing.GroupLayout(PanelThongKeTheoNam);
        PanelThongKeTheoNam.setLayout(PanelThongKeTheoNamLayout);
        PanelThongKeTheoNamLayout.setHorizontalGroup(
            PanelThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoNamLayout.createSequentialGroup()
                .addGap(197, 197, 197)
                .addComponent(lblNamBatDau, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbNamBatDau, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(27, 27, 27)
                .addComponent(lblNamKetThuc)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbNamKetThuc, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(52, 52, 52)
                .addComponent(btnInPDF, javax.swing.GroupLayout.PREFERRED_SIZE, 118, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(28, 28, 28)
                .addComponent(btnXuatExcel, javax.swing.GroupLayout.PREFERRED_SIZE, 118, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(PanelThongKeTheoNamLayout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 995, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 17, Short.MAX_VALUE))
        );
        PanelThongKeTheoNamLayout.setVerticalGroup(
            PanelThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoNamLayout.createSequentialGroup()
                .addGroup(PanelThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(PanelThongKeTheoNamLayout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(PanelThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblNamBatDau, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lblNamKetThuc, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cbNamBatDau, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cbNamKetThuc, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(17, 17, 17))
                    .addGroup(PanelThongKeTheoNamLayout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(PanelThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(btnInPDF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btnXuatExcel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 285, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanelChartNam.setBackground(new java.awt.Color(102, 51, 255));
        jPanelChartNam.setLayout(new java.awt.BorderLayout());

        javax.swing.GroupLayout ThongKeTheoNamLayout = new javax.swing.GroupLayout(ThongKeTheoNam);
        ThongKeTheoNam.setLayout(ThongKeTheoNamLayout);
        ThongKeTheoNamLayout.setHorizontalGroup(
            ThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(PanelThongKeTheoNam, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(ThongKeTheoNamLayout.createSequentialGroup()
                .addComponent(jPanelChartNam, javax.swing.GroupLayout.PREFERRED_SIZE, 995, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        ThongKeTheoNamLayout.setVerticalGroup(
            ThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ThongKeTheoNamLayout.createSequentialGroup()
                .addComponent(PanelThongKeTheoNam, javax.swing.GroupLayout.PREFERRED_SIZE, 334, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanelChartNam, javax.swing.GroupLayout.PREFERRED_SIZE, 309, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(75, Short.MAX_VALUE))
        );

        jTabbedPanel.addTab("Thống kê theo năm", ThongKeTheoNam);

        ThongKeTheoThangTrongNam.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ThongKeTheoThangTrongNamMouseClicked(evt);
            }
        });

        cbNam.setToolTipText("");
        cbNam.setBorder(null);

        tableTheoThang.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Tháng", "Vốn ", "Doanh thu", "Lợi nhuận"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        tableTheoThang.setEnabled(false);
        tableTheoThang.setFocusable(false);
        jScrollPane2.setViewportView(tableTheoThang);

        lblNam.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNam.setForeground(new java.awt.Color(135, 172, 217));
        lblNam.setText("Chọn năm");

        btnThem.setBorder(null);
        btnThem.setForeground(new java.awt.Color(135, 172, 217));
        btnThem.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem.setText("In pdf");
        btnThem.setFocusPainted(false);
        btnThem.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem.setRadius(40);
        btnThem.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThemActionPerformed(evt);
            }
        });

        btnThem1.setBorder(null);
        btnThem1.setForeground(new java.awt.Color(135, 172, 217));
        btnThem1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem1.setText("Thống kê");
        btnThem1.setFocusPainted(false);
        btnThem1.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem1.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem1.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem1.setRadius(40);
        btnThem1.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem1ActionPerformed(evt);
            }
        });

        btnThem2.setBorder(null);
        btnThem2.setForeground(new java.awt.Color(135, 172, 217));
        btnThem2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem2.setText("Xuất excel");
        btnThem2.setFocusPainted(false);
        btnThem2.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem2.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem2.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem2.setRadius(40);
        btnThem2.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout PanelThongKeTheoThangLayout = new javax.swing.GroupLayout(PanelThongKeTheoThang);
        PanelThongKeTheoThang.setLayout(PanelThongKeTheoThangLayout);
        PanelThongKeTheoThangLayout.setHorizontalGroup(
            PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoThangLayout.createSequentialGroup()
                .addGroup(PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane2)
                    .addGroup(PanelThongKeTheoThangLayout.createSequentialGroup()
                        .addGap(272, 272, 272)
                        .addComponent(lblNam)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbNam, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(191, 191, 191)
                        .addComponent(btnThem1, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnThem2, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnThem, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 8, Short.MAX_VALUE)))
                .addContainerGap())
        );
        PanelThongKeTheoThangLayout.setVerticalGroup(
            PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoThangLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(lblNam, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbNam, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(btnThem, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnThem1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btnThem2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 302, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(17, 17, 17))
        );

        jPanelChartThang.setBackground(new java.awt.Color(102, 51, 255));
        jPanelChartThang.setLayout(new java.awt.BorderLayout());

        javax.swing.GroupLayout ThongKeTheoThangTrongNamLayout = new javax.swing.GroupLayout(ThongKeTheoThangTrongNam);
        ThongKeTheoThangTrongNam.setLayout(ThongKeTheoThangTrongNamLayout);
        ThongKeTheoThangTrongNamLayout.setHorizontalGroup(
            ThongKeTheoThangTrongNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(PanelThongKeTheoThang, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(ThongKeTheoThangTrongNamLayout.createSequentialGroup()
                .addComponent(jPanelChartThang, javax.swing.GroupLayout.PREFERRED_SIZE, 1002, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        ThongKeTheoThangTrongNamLayout.setVerticalGroup(
            ThongKeTheoThangTrongNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ThongKeTheoThangTrongNamLayout.createSequentialGroup()
                .addComponent(PanelThongKeTheoThang, javax.swing.GroupLayout.PREFERRED_SIZE, 353, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanelChartThang, javax.swing.GroupLayout.PREFERRED_SIZE, 291, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(74, Short.MAX_VALUE))
        );

        jTabbedPanel.addTab("Thống kê từng tháng trong năm", ThongKeTheoThangTrongNam);

        ThongKeTheoNgayTrongThang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ThongKeTheoNgayTrongThangMouseClicked(evt);
            }
        });

        tableTheoTungNgayTrongThang.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Ngày", "Vốn ", "Doanh thu", "Lợi nhuận"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        tableTheoTungNgayTrongThang.setEnabled(false);
        tableTheoTungNgayTrongThang.setFocusable(false);
        jScrollPane6.setViewportView(tableTheoTungNgayTrongThang);

        lblNam1.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNam1.setForeground(new java.awt.Color(135, 172, 217));
        lblNam1.setText("Chọn năm");

        cbThang.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Tháng 1", "Tháng 2", "Tháng 3", "Tháng 4", "Tháng 5", "Tháng 6", "Tháng 7", "Tháng 8", "Tháng 9", "Tháng 10", "Tháng 11", "Tháng 12" }));
        cbThang.setToolTipText("");
        cbThang.setBorder(null);

        lblNamKetThuc2.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNamKetThuc2.setForeground(new java.awt.Color(135, 172, 217));
        lblNamKetThuc2.setText("Chọn tháng");

        btnThem3.setBorder(null);
        btnThem3.setForeground(new java.awt.Color(135, 172, 217));
        btnThem3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem3.setText("In pdf");
        btnThem3.setFocusPainted(false);
        btnThem3.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem3.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem3.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem3.setRadius(40);
        btnThem3.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem3ActionPerformed(evt);
            }
        });

        btnThongKe1.setBorder(null);
        btnThongKe1.setForeground(new java.awt.Color(135, 172, 217));
        btnThongKe1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThongKe1.setText("Thống kê");
        btnThongKe1.setFocusPainted(false);
        btnThongKe1.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThongKe1.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThongKe1.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThongKe1.setRadius(40);
        btnThongKe1.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThongKe1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnThongKe1MouseClicked(evt);
            }
        });
        btnThongKe1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThongKe1ActionPerformed(evt);
            }
        });

        btnThem5.setBorder(null);
        btnThem5.setForeground(new java.awt.Color(135, 172, 217));
        btnThem5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem5.setText("Xuất excel");
        btnThem5.setFocusPainted(false);
        btnThem5.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem5.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem5.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem5.setRadius(40);
        btnThem5.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem5ActionPerformed(evt);
            }
        });

        cbNam1.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbNam1ItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout PanelThongKeTheoThang1Layout = new javax.swing.GroupLayout(PanelThongKeTheoThang1);
        PanelThongKeTheoThang1.setLayout(PanelThongKeTheoThang1Layout);
        PanelThongKeTheoThang1Layout.setHorizontalGroup(
            PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoThang1Layout.createSequentialGroup()
                .addGroup(PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 998, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(PanelThongKeTheoThang1Layout.createSequentialGroup()
                        .addComponent(lblNam1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbNam1, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(44, 44, 44)
                        .addComponent(lblNamKetThuc2, javax.swing.GroupLayout.PREFERRED_SIZE, 84, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(cbThang, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(184, 184, 184)
                        .addComponent(btnThongKe1, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(btnThem5, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnThem3, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(14, Short.MAX_VALUE))
        );
        PanelThongKeTheoThang1Layout.setVerticalGroup(
            PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoThang1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(lblNam1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(lblNamKetThuc2, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbThang, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbNam1, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(btnThem3, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnThongKe1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btnThem5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, 0)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.DEFAULT_SIZE, 313, Short.MAX_VALUE)
                .addGap(0, 0, 0))
        );

        jPanelChartNgay.setBackground(new java.awt.Color(102, 51, 255));
        jPanelChartNgay.setLayout(new java.awt.BorderLayout());

        javax.swing.GroupLayout ThongKeTheoNgayTrongThangLayout = new javax.swing.GroupLayout(ThongKeTheoNgayTrongThang);
        ThongKeTheoNgayTrongThang.setLayout(ThongKeTheoNgayTrongThangLayout);
        ThongKeTheoNgayTrongThangLayout.setHorizontalGroup(
            ThongKeTheoNgayTrongThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(PanelThongKeTheoThang1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanelChartNgay, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        ThongKeTheoNgayTrongThangLayout.setVerticalGroup(
            ThongKeTheoNgayTrongThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ThongKeTheoNgayTrongThangLayout.createSequentialGroup()
                .addComponent(PanelThongKeTheoThang1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanelChartNgay, javax.swing.GroupLayout.PREFERRED_SIZE, 289, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jTabbedPanel.addTab("Thống kê từng ngày trong tháng", ThongKeTheoNgayTrongThang);

        ThongKeTuNgayDenNgay.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ThongKeTuNgayDenNgayMouseClicked(evt);
            }
        });

        TableTuNgayDenNgay.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Ngày", "Vốn ", "Doanh thu", "Lợi nhuận"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        TableTuNgayDenNgay.setEnabled(false);
        TableTuNgayDenNgay.setFocusable(false);
        jScrollPane7.setViewportView(TableTuNgayDenNgay);

        lblNam2.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNam2.setForeground(new java.awt.Color(135, 172, 217));
        lblNam2.setText("Ngày bắt đầu");

        btnThem6.setBorder(null);
        btnThem6.setForeground(new java.awt.Color(135, 172, 217));
        btnThem6.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem6.setText("In pdf");
        btnThem6.setFocusPainted(false);
        btnThem6.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem6.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem6.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem6.setRadius(40);
        btnThem6.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem6ActionPerformed(evt);
            }
        });

        btnThem7.setBorder(null);
        btnThem7.setForeground(new java.awt.Color(135, 172, 217));
        btnThem7.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem7.setText("Thống kê");
        btnThem7.setFocusPainted(false);
        btnThem7.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem7.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem7.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem7.setRadius(40);
        btnThem7.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem7ActionPerformed(evt);
            }
        });

        btnThem8.setBorder(null);
        btnThem8.setForeground(new java.awt.Color(135, 172, 217));
        btnThem8.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem8.setText("Xuất excel");
        btnThem8.setFocusPainted(false);
        btnThem8.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem8.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem8.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem8.setRadius(40);
        btnThem8.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem8ActionPerformed(evt);
            }
        });

        lblNam3.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNam3.setForeground(new java.awt.Color(135, 172, 217));
        lblNam3.setText("Ngày bắt đầu");

        javax.swing.GroupLayout PanelThongKeTheoThang2Layout = new javax.swing.GroupLayout(PanelThongKeTheoThang2);
        PanelThongKeTheoThang2.setLayout(PanelThongKeTheoThang2Layout);
        PanelThongKeTheoThang2Layout.setHorizontalGroup(
            PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, PanelThongKeTheoThang2Layout.createSequentialGroup()
                .addGap(41, 41, 41)
                .addComponent(lblNam3, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(NgayBatDau, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(lblNam2, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(NgayKetThuc, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(52, 52, 52)
                .addComponent(btnThem7, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btnThem8, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(16, 16, 16)
                .addComponent(btnThem6, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(12, 12, 12))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, PanelThongKeTheoThang2Layout.createSequentialGroup()
                .addContainerGap(14, Short.MAX_VALUE)
                .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 974, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(24, 24, 24))
        );
        PanelThongKeTheoThang2Layout.setVerticalGroup(
            PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoThang2Layout.createSequentialGroup()
                .addGap(16, 16, 16)
                .addGroup(PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnThem7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnThem8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnThem6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                        .addComponent(lblNam2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(NgayKetThuc, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                        .addComponent(lblNam3, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(NgayBatDau, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 561, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(89, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout ThongKeTuNgayDenNgayLayout = new javax.swing.GroupLayout(ThongKeTuNgayDenNgay);
        ThongKeTuNgayDenNgay.setLayout(ThongKeTuNgayDenNgayLayout);
        ThongKeTuNgayDenNgayLayout.setHorizontalGroup(
            ThongKeTuNgayDenNgayLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(PanelThongKeTheoThang2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        ThongKeTuNgayDenNgayLayout.setVerticalGroup(
            ThongKeTuNgayDenNgayLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(PanelThongKeTheoThang2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        jTabbedPanel.addTab("Thống kê từ ngày đến ngày", ThongKeTuNgayDenNgay);

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jTabbedPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 1012, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPanel)
        );

        jTabbedPane1.addTab("Doanh thu", jPanel2);

        TableSanPham.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null}
            },
            new String [] {
                "STT", "MaSP", "TenSP", "SL bán", "SL đơn  bán", "Doanh thu "
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane3.setViewportView(TableSanPham);
        if (TableSanPham.getColumnModel().getColumnCount() > 0) {
            TableSanPham.getColumnModel().getColumn(1).setMinWidth(120);
            TableSanPham.getColumnModel().getColumn(1).setPreferredWidth(120);
            TableSanPham.getColumnModel().getColumn(1).setMaxWidth(120);
            TableSanPham.getColumnModel().getColumn(2).setMinWidth(300);
            TableSanPham.getColumnModel().getColumn(2).setPreferredWidth(300);
            TableSanPham.getColumnModel().getColumn(2).setMaxWidth(300);
            TableSanPham.getColumnModel().getColumn(3).setMinWidth(110);
            TableSanPham.getColumnModel().getColumn(3).setPreferredWidth(110);
            TableSanPham.getColumnModel().getColumn(3).setMaxWidth(110);
            TableSanPham.getColumnModel().getColumn(4).setMinWidth(110);
            TableSanPham.getColumnModel().getColumn(4).setPreferredWidth(110);
            TableSanPham.getColumnModel().getColumn(4).setMaxWidth(110);
            TableSanPham.getColumnModel().getColumn(5).setMinWidth(180);
            TableSanPham.getColumnModel().getColumn(5).setPreferredWidth(180);
            TableSanPham.getColumnModel().getColumn(5).setMaxWidth(180);
        }

        CbThoiGianSanPham.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Hôm nay", "Hôm qua", "7 ngày qua", "30 ngày qua", "Tháng trước", "Tháng này", "Năm trước", "Năm nay", "Tùy chọn khác" }));
        CbThoiGianSanPham.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                CbThoiGianSanPhamItemStateChanged(evt);
            }
        });
        CbThoiGianSanPham.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CbThoiGianSanPhamActionPerformed(evt);
            }
        });

        lblThoiGian.setText("Khoảng thời gian");

        CbTieuChi.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "sản phẩm bán chạy", "doanh thu cao nhất", " " }));
        CbTieuChi.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                CbTieuChiItemStateChanged(evt);
            }
        });

        btnThem13.setBorder(null);
        btnThem13.setForeground(new java.awt.Color(135, 172, 217));
        btnThem13.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem13.setText("Xuất excel");
        btnThem13.setFocusPainted(false);
        btnThem13.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem13.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem13.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem13.setRadius(40);
        btnThem13.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem13.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem13ActionPerformed(evt);
            }
        });

        btnThem14.setBorder(null);
        btnThem14.setForeground(new java.awt.Color(135, 172, 217));
        btnThem14.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem14.setText("In pdf");
        btnThem14.setFocusPainted(false);
        btnThem14.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem14.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem14.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem14.setRadius(40);
        btnThem14.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem14.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem14ActionPerformed(evt);
            }
        });

        spngayketthuc.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                spngayketthucPropertyChange(evt);
            }
        });

        spngaybatdau.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                spngaybatdauPropertyChange(evt);
            }
        });

        jPanelChartSanPhamBan.setBackground(new java.awt.Color(255, 102, 153));
        jPanelChartSanPhamBan.setLayout(new java.awt.BorderLayout());

        cbTopSanPham.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Tất cả", "Top 3", "Top 5", "Top 10", "Top 20" }));
        cbTopSanPham.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbTopSanPhamItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(lblThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(CbThoiGianSanPham, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(spngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(spngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(CbTieuChi, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbTopSanPham, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(16, 16, 16)
                        .addComponent(btnThem13, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnThem14, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18))
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 979, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(16, Short.MAX_VALUE))
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jPanelChartSanPhamBan, javax.swing.GroupLayout.PREFERRED_SIZE, 979, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                .addComponent(btnThem13, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(btnThem14, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(CbThoiGianSanPham, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(lblThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(CbTieuChi, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(cbTopSanPham, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(spngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(spngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 286, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanelChartSanPhamBan, javax.swing.GroupLayout.PREFERRED_SIZE, 310, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(76, 76, 76))
        );

        jTabbedPaneTheLoai.addTab("Sản phẩm", jPanel7);

        TableTheLoai.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null}
            },
            new String [] {
                "STT", "MaTL", "TenTL", "SL bán", "Số loại SP", "SL đơn  bán", "Doanh thu "
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.Integer.class, java.lang.Object.class, java.lang.Integer.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane9.setViewportView(TableTheLoai);
        if (TableTheLoai.getColumnModel().getColumnCount() > 0) {
            TableTheLoai.getColumnModel().getColumn(1).setMinWidth(120);
            TableTheLoai.getColumnModel().getColumn(1).setPreferredWidth(120);
            TableTheLoai.getColumnModel().getColumn(1).setMaxWidth(120);
            TableTheLoai.getColumnModel().getColumn(2).setMinWidth(300);
            TableTheLoai.getColumnModel().getColumn(2).setPreferredWidth(300);
            TableTheLoai.getColumnModel().getColumn(2).setMaxWidth(300);
            TableTheLoai.getColumnModel().getColumn(3).setMinWidth(110);
            TableTheLoai.getColumnModel().getColumn(3).setPreferredWidth(110);
            TableTheLoai.getColumnModel().getColumn(3).setMaxWidth(110);
            TableTheLoai.getColumnModel().getColumn(5).setMinWidth(110);
            TableTheLoai.getColumnModel().getColumn(5).setPreferredWidth(110);
            TableTheLoai.getColumnModel().getColumn(5).setMaxWidth(110);
            TableTheLoai.getColumnModel().getColumn(6).setMinWidth(180);
            TableTheLoai.getColumnModel().getColumn(6).setPreferredWidth(180);
            TableTheLoai.getColumnModel().getColumn(6).setMaxWidth(180);
        }

        CbThoiGianTheLoai.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Hôm nay", "Hôm qua", "7 ngày qua", "30 ngày qua", "Tháng trước", "Tháng này", "Năm trước", "Năm nay", "Tùy chọn khác" }));
        CbThoiGianTheLoai.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                CbThoiGianTheLoaiItemStateChanged(evt);
            }
        });
        CbThoiGianTheLoai.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CbThoiGianTheLoaiActionPerformed(evt);
            }
        });

        lblThoiGian2.setText("Khoảng thời gian");

        CbTieuChiTheLoai.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Thể loại bán chạy", "Doanh thu cao nhất", " " }));

        btnThem18.setBorder(null);
        btnThem18.setForeground(new java.awt.Color(135, 172, 217));
        btnThem18.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem18.setText("Xuất excel");
        btnThem18.setFocusPainted(false);
        btnThem18.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem18.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem18.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem18.setRadius(40);
        btnThem18.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem18.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem18ActionPerformed(evt);
            }
        });

        btnThem19.setBorder(null);
        btnThem19.setForeground(new java.awt.Color(135, 172, 217));
        btnThem19.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/add.png"))); // NOI18N
        btnThem19.setText("In pdf");
        btnThem19.setFocusPainted(false);
        btnThem19.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem19.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem19.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem19.setRadius(40);
        btnThem19.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnThem19.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem19ActionPerformed(evt);
            }
        });

        tlngayketthuc.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                tlngayketthucPropertyChange(evt);
            }
        });

        tlngaybatdau.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                tlngaybatdauPropertyChange(evt);
            }
        });

        jPanelChartTheLoai.setBackground(new java.awt.Color(255, 102, 153));
        jPanelChartTheLoai.setLayout(new java.awt.BorderLayout());

        cbTopTheLoai.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Tất cả", "Top 3", "Top 5", "Top 10", "Top 20" }));
        cbTopTheLoai.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbTopTheLoaiItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(lblThoiGian2, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(CbThoiGianTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(tlngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(tlngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(CbTieuChiTheLoai, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbTopTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(16, 16, 16)
                        .addComponent(btnThem18, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnThem19, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18))
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(jScrollPane9, javax.swing.GroupLayout.PREFERRED_SIZE, 979, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(16, Short.MAX_VALUE))
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(jPanelChartTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 979, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                .addComponent(btnThem18, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(btnThem19, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(CbThoiGianTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(lblThoiGian2, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(CbTieuChiTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(cbTopTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(tlngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(tlngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane9, javax.swing.GroupLayout.PREFERRED_SIZE, 286, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanelChartTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 312, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(74, 74, 74))
        );

        jTabbedPaneTheLoai.addTab("Thể loại", jPanel12);

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPaneTheLoai)
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPaneTheLoai)
        );

        jTabbedPane1.addTab("Bán hàng", jPanel1);

        TableThoiGian.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "STT", "Thời gian", "Số lượng đơn", "Số lượng SP", "Doanh thu"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane4.setViewportView(TableThoiGian);

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 989, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGap(76, 76, 76)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 340, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(339, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Khách mua hàng theo thời gian", jPanel9);

        jPanel3.setBackground(new java.awt.Color(0, 204, 204));

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1012, Short.MAX_VALUE)
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 684, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Tồn kho", jPanel4);

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1012, Short.MAX_VALUE)
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 755, Short.MAX_VALUE)
        );

        jTabbedPane1.addTab("Nhân viên", jPanel6);

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 80, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 1001, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(13, Short.MAX_VALUE))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, 0)
                .addComponent(jTabbedPane1))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1020, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, 0)
                    .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 756, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void jTabbedPanelMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTabbedPanelMouseClicked
        // TODO add your handling code here:
//        ArrayList<ThongKeDoanhThuDTO> result = tkBUS.thongKeDoanhThuTheoNam();
//        loadDataTableDoanhThu((DefaultTableModel) tableTheoNam.getModel(), result);
//        loadDataChartTheoNam(result);
//        populateComboBox(cbNamBatDau);
//        populateComboBox(cbNamKetThuc);
    }//GEN-LAST:event_jTabbedPanelMouseClicked

    private void ThongKeTheoThangTrongNamMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ThongKeTheoThangTrongNamMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ThongKeTheoThangTrongNamMouseClicked

    private void ThongKeTheoNamMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ThongKeTheoNamMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ThongKeTheoNamMouseClicked

    private void btnXuatExcelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXuatExcelActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnXuatExcelActionPerformed

    private void btnInPDFActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnInPDFActionPerformed
        // TODO add your handling code here:
        ArrayList<ThongKeDoanhThuDTO> list = getDataFromTableTheoNam();
        String namBatDau = cbNamBatDau.getSelectedItem().toString();
        String namKetThuc = cbNamKetThuc.getSelectedItem().toString();
        // Gọi hàm chọn đường dẫn
        String filePath = PdfExporter.chooseFilePath();
        if (filePath != null) {
            PdfExporter.exportToPdf(list, filePath,namBatDau,namKetThuc,"Nguyễn Minh Thuận");
        } else {

        }

    }//GEN-LAST:event_btnInPDFActionPerformed

    private void btnThemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThemActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThemActionPerformed

    private void btnThem1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem1ActionPerformed
        // TODO add your handling code here:
        thongKeDoanhThuTheoThangTrongNam();
    }//GEN-LAST:event_btnThem1ActionPerformed

    private void btnThem2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem2ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThem2ActionPerformed

    private void btnThem3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem3ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThem3ActionPerformed

    private void btnThongKe1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThongKe1ActionPerformed
        // TODO add your handling code here:
        ThongKeDoanhThuTungNgayTrongThang();
    }//GEN-LAST:event_btnThongKe1ActionPerformed

    private void btnThem5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem5ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThem5ActionPerformed

    private void ThongKeTheoNgayTrongThangMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ThongKeTheoNgayTrongThangMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ThongKeTheoNgayTrongThangMouseClicked

    private void btnThem6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem6ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThem6ActionPerformed

    private void btnThem7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem7ActionPerformed
        // TODO add your handling code here:
        ThongKeDoanhThuTuNgayDenNgay();
    }//GEN-LAST:event_btnThem7ActionPerformed

    private void btnThem8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem8ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThem8ActionPerformed

    private void ThongKeTuNgayDenNgayMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ThongKeTuNgayDenNgayMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ThongKeTuNgayDenNgayMouseClicked

    private void btnThem13ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem13ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThem13ActionPerformed

    private void btnThem14ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem14ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThem14ActionPerformed

    private void btnThongKe1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnThongKe1MouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThongKe1MouseClicked

    private void CbThoiGianSanPhamActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CbThoiGianSanPhamActionPerformed
        // TODO add your handling code here:
        updateDateChoosers(spngaybatdau, spngayketthuc, CbThoiGianSanPham);
    }//GEN-LAST:event_CbThoiGianSanPhamActionPerformed

    private void CbThoiGianSanPhamItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_CbThoiGianSanPhamItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_CbThoiGianSanPhamItemStateChanged

    private void spngaybatdauPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_spngaybatdauPropertyChange
        // TODO add your handling code here:

    }//GEN-LAST:event_spngaybatdauPropertyChange

    private void spngayketthucPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_spngayketthucPropertyChange
        // TODO add your handling code here:
        thongKeSanPhamBanTrongKhoangThoiGian();
    }//GEN-LAST:event_spngayketthucPropertyChange

    private void cbTopSanPhamItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbTopSanPhamItemStateChanged
        // TODO add your handling code here:
        thongKeSanPhamBanTrongKhoangThoiGian();
    }//GEN-LAST:event_cbTopSanPhamItemStateChanged

    private void CbThoiGianTheLoaiItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_CbThoiGianTheLoaiItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_CbThoiGianTheLoaiItemStateChanged

    private void CbThoiGianTheLoaiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CbThoiGianTheLoaiActionPerformed
        // TODO add your handling code here:
        updateDateChoosers(tlngaybatdau, tlngayketthuc, CbThoiGianTheLoai);
    }//GEN-LAST:event_CbThoiGianTheLoaiActionPerformed

    private void btnThem18ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem18ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThem18ActionPerformed

    private void btnThem19ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem19ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnThem19ActionPerformed

    private void tlngayketthucPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_tlngayketthucPropertyChange
        // TODO add your handling code here:
        thongKeTheLoaiBanTrongKhoangThoiGian();
    }//GEN-LAST:event_tlngayketthucPropertyChange

    private void tlngaybatdauPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_tlngaybatdauPropertyChange
        // TODO add your handling code here:
    }//GEN-LAST:event_tlngaybatdauPropertyChange

    private void cbTopTheLoaiItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbTopTheLoaiItemStateChanged
        // TODO add your handling code here:
        thongKeTheLoaiBanTrongKhoangThoiGian();
    }//GEN-LAST:event_cbTopTheLoaiItemStateChanged

    private void CbTieuChiItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_CbTieuChiItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_CbTieuChiItemStateChanged

    private void cbNamKetThucItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbNamKetThucItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_cbNamKetThucItemStateChanged

    private void cbNamBatDauItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbNamBatDauItemStateChanged
        // TODO add your handling code here:

    }//GEN-LAST:event_cbNamBatDauItemStateChanged

    private void cbNam1ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbNam1ItemStateChanged
        // TODO add your handling code here:

    }//GEN-LAST:event_cbNam1ItemStateChanged

    private void cbNamBatDauActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbNamBatDauActionPerformed
        // TODO add your handling code here:
        thongKeDoanhThuTuNamDenNam();
    }//GEN-LAST:event_cbNamBatDauActionPerformed

    private void cbNamKetThucActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbNamKetThucActionPerformed
        // TODO add your handling code here:
        thongKeDoanhThuTuNamDenNam();
    }//GEN-LAST:event_cbNamKetThucActionPerformed

    private void jTabbedPane1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTabbedPane1MouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_jTabbedPane1MouseClicked

    private void populateComboBox(JComboBox<String> comboBox) {
        Set<Integer> years = tkBUS.getDistinctYears();

        // Chuyển Set thành List và sắp xếp giảm dần
        List<Integer> sortedYears = new ArrayList<>(years);
        Collections.sort(sortedYears, Collections.reverseOrder());

        // Xóa tất cả các item cũ trong ComboBox
        comboBox.removeAllItems();

        // Thêm các năm đã sắp xếp vào ComboBox
        for (Integer year : sortedYears) {
            comboBox.addItem(year + "");
        }

    }

    private void loadDataTableDoanhThu(DefaultTableModel tableModel, ArrayList<ThongKeDoanhThuDTO> ketQua) {
        // Xóa dữ liệu cũ trong model
        tableModel.setRowCount(0);

        // Thêm dữ liệu mới từ danh sách vào model
        for (ThongKeDoanhThuDTO doanhThu : ketQua) {
            String von = sharedFunction.formatVND(doanhThu.getVon());
            String doanhthu = sharedFunction.formatVND(doanhThu.getDoanhThu());
            String loiNhuan = sharedFunction.formatVND(doanhThu.getLoiNhuan());
            Object[] rowData = {doanhThu.getThoiGian(), von, doanhthu, loiNhuan};
            tableModel.addRow(rowData);
        }
    }

    private void loadDataTableSanPhamBan(DefaultTableModel tableModel, ArrayList<ThongKeSanPhamBanDTO> ketQua, int selectedRowCount) {
        // Xóa dữ liệu cũ trong model
        tableModel.setRowCount(0);

        // Thêm dữ liệu mới từ danh sách vào model
        int count = 0;
        for (ThongKeSanPhamBanDTO sp : ketQua) {
            if (count >= selectedRowCount) {
                break; // Đã hiển thị đủ số lượng dòng được chọn
            }

            String masp = sharedFunction.FormatID("SP", Integer.parseInt(sp.getMaSP()));
            String tenSP = sp.getTenSP();
            int soLuong = sp.getSoLuong();
            int soLuongDon = sp.getSoLuongDon();
            String doanhthu = sharedFunction.formatVND(sp.getDoanhThu());
            Object[] rowData = {count + 1, masp, tenSP, soLuong, soLuongDon, doanhthu};
            tableModel.addRow(rowData);

            count++;
        }
    }

    private void loadDataTableTheLoaiBan(DefaultTableModel tableModel, ArrayList<ThongKeTheLoaiBanDTO> ketQua, int selectedRowCount) {
        // Xóa dữ liệu cũ trong model
        tableModel.setRowCount(0);

        // Thêm dữ liệu mới từ danh sách vào model
        int count = 0;
        for (ThongKeTheLoaiBanDTO tl : ketQua) {
            if (count >= selectedRowCount) {
                break; // Đã hiển thị đủ số lượng dòng được chọn
            }

            String masp = sharedFunction.FormatID("TL", Integer.parseInt(tl.getMaTL()));
            String tenSP = tl.getTenTL();
            int soLuong = tl.getSoLuong();
            int soLuongDon = tl.getSoLuongDon();
            int soLoaiSP = tl.getSoLoaiSP();
            String doanhthu = sharedFunction.formatVND(tl.getDoanhThu());
            Object[] rowData = {count + 1, masp, tenSP, soLuong, soLoaiSP, soLuongDon, doanhthu};
            tableModel.addRow(rowData);

            count++;
        }
    }

    private void formatTable() {
        sharedFunction.EditHeaderTable(tableTheoNam);
        sharedFunction.EditTableContent(tableTheoNam);
        sharedFunction.EditHeaderTable(tableTheoThang);
        sharedFunction.EditTableContent(tableTheoThang);
        sharedFunction.EditHeaderTable(TableTuNgayDenNgay);
        sharedFunction.EditTableContent(TableTuNgayDenNgay);
        sharedFunction.EditHeaderTable(tableTheoTungNgayTrongThang);
        sharedFunction.EditTableContent(tableTheoTungNgayTrongThang);
        sharedFunction.EditHeaderTable(TableSanPham);
        sharedFunction.EditTableContent(TableSanPham);
        sharedFunction.EditHeaderTable(TableTheLoai);
        sharedFunction.EditTableContent(TableTheLoai);
        sharedFunction.EditHeaderTable(TableThoiGian);
        sharedFunction.EditTableContent(TableThoiGian);

    }

    private void populateComboBoxALL() {
        populateComboBox(cbNamBatDau);
        populateComboBox(cbNamKetThuc);
        populateComboBox(cbNam);
        populateComboBox(cbNam1);
    }

    private void thongKeDoanhThuTuNamDenNam() {
        String selectedNamBatDau = (String) cbNamBatDau.getSelectedItem();
        String selectedNamKetThuc = (String) cbNamKetThuc.getSelectedItem();

        if (selectedNamBatDau == null || selectedNamKetThuc == null) {
            return;
        }

        int namBatDau = Integer.parseInt(selectedNamBatDau);
        int namKetThuc = Integer.parseInt(selectedNamKetThuc);

        if (!isValidYearRange(namBatDau, namKetThuc)) {
            return;
        }

        ArrayList<ThongKeDoanhThuDTO> result = tkBUS.thongKeDoanhThuTuNamDenNam(namBatDau, namKetThuc);
        loadDataTableDoanhThu((DefaultTableModel) tableTheoNam.getModel(), result);
        loadDataChartTheoNam(result);
    }

    private void thongKeDoanhThuTheoThangTrongNam() {
        int selectedYear = Integer.parseInt((String) cbNam.getSelectedItem());
        ArrayList<ThongKeDoanhThuDTO> result = tkBUS.thongKeDoanhThuTheoThang(selectedYear);
        loadDataTableDoanhThu((DefaultTableModel) tableTheoThang.getModel(), result);
        loadDataChartTheoThang(result);
    }

    private void ThongKeDoanhThuTungNgayTrongThang() {
        String selectedMonthString = cbThang.getSelectedItem().toString();
        int selectedYear = Integer.parseInt((String) cbNam1.getSelectedItem());
        String monthNumberString = selectedMonthString.substring(6);
        int selectedMonth = Integer.parseInt(monthNumberString);
        ArrayList<ThongKeDoanhThuDTO> result = tkBUS.thongKeDoanhThuTungNgayTrongThang(selectedYear, selectedMonth);
        loadDataTableDoanhThu((DefaultTableModel) tableTheoTungNgayTrongThang.getModel(), result);
        loadDataChartTungNgayTrongThang(result);

    }

    private void ThongKeDoanhThuTuNgayDenNgay() {
        // Lấy ngày bắt đầu và kết thúc từ JDateChooser
        java.util.Date startDate = NgayBatDau.getDate();
        java.util.Date endDate = NgayKetThuc.getDate();
        // Kiểm tra ngày bắt đầu và kết thúc
        if (!isValidDateRange(startDate, endDate)) {
            JOptionPane.showMessageDialog(this, "Ngày bắt đầu không được lớn hơn ngày kết thúc", "Lỗi", JOptionPane.ERROR_MESSAGE);
            return;
        }
        ArrayList<ThongKeDoanhThuDTO> result = tkBUS.thongKeDoanhThuTuNgayDenNgay(startDate, endDate);
        loadDataTableDoanhThu((DefaultTableModel) TableTuNgayDenNgay.getModel(), result);
    }

    private void loadDataChartTungNgayTrongThang(ArrayList<ThongKeDoanhThuDTO> list) {
        jPanelChartNgay.removeAll();
        chart = new Chart();
//        chart.addLegend("Vốn", new Color(245, 189, 135));
        chart.addLegend("Doanh thu", new Color(135, 189, 245));
//        chart.addLegend("Lợi nhuận", new Color(189, 135, 245));
        for (ThongKeDoanhThuDTO i : list) {
//            chart.addData(new ModelChart("" + i.getThoiGian(), new double[]{i.getVon(), i.getDoanhThu(), i.getLoiNhuan()}));
            chart.addData(new ModelChart("" + i.getThoiGian(), new double[]{i.getDoanhThu()}));
        }
        chart.repaint();
        chart.validate();
        jPanelChartNgay.add(chart);
        jPanelChartNgay.repaint();
        jPanelChartNgay.validate();
    }

    private void loadDataChartTheoNam(ArrayList<ThongKeDoanhThuDTO> list) {
        jPanelChartNam.removeAll();
        chart = new Chart();
        chart.addLegend("Vốn", new Color(245, 189, 135));
        chart.addLegend("Doanh thu", new Color(135, 189, 245));
        chart.addLegend("Lợi nhuận", new Color(189, 135, 245));
        for (ThongKeDoanhThuDTO i : list) {
            chart.addData(new ModelChart("Năm " + i.getThoiGian(), new double[]{i.getVon(), i.getDoanhThu(), i.getLoiNhuan()}));
        }
        chart.repaint();
        chart.validate();
        jPanelChartNam.add(chart);
        jPanelChartNam.repaint();
        jPanelChartNam.validate();
    }

    private void loadDataChartTheoThang(ArrayList<ThongKeDoanhThuDTO> list) {
        jPanelChartThang.removeAll();
        chart = new Chart();
        chart.addLegend("Vốn", new Color(245, 189, 135));
        chart.addLegend("Doanh thu", new Color(135, 189, 245));
        chart.addLegend("Lợi nhuận", new Color(189, 135, 245));
        for (ThongKeDoanhThuDTO i : list) {
            chart.addData(new ModelChart("Tháng" + i.getThoiGian(), new double[]{i.getVon(), i.getDoanhThu(), i.getLoiNhuan()}));
        }
        chart.repaint();
        chart.validate();
        jPanelChartThang.add(chart);
        jPanelChartThang.repaint();
        jPanelChartThang.validate();
    }
// thống kê sản phẩm bán

    private void updateDateChoosers(JDateChooser ngaybatdau, JDateChooser ngayketthuc, JComboBox<String> cb) {
        String selectedRange = (String) cb.getSelectedItem();

        Calendar calendar = Calendar.getInstance();
        // Set định dạng ngày tháng năm cho JDateChooser
        ngaybatdau.setDateFormatString("dd/MM/yyyy");
        ngayketthuc.setDateFormatString("dd/MM/yyyy");

        if ("Hôm nay".equals(selectedRange)) {
            ngaybatdau.setDate(calendar.getTime());
            ngayketthuc.setDate(calendar.getTime());
        } else if ("Hôm qua".equals(selectedRange)) {
            calendar.add(Calendar.DATE, -1);
            ngaybatdau.setDate(calendar.getTime());
            ngayketthuc.setDate(calendar.getTime());
        } else if ("7 ngày qua".equals(selectedRange)) {
            calendar.add(Calendar.DATE, -6);
            ngaybatdau.setDate(calendar.getTime());
            ngayketthuc.setDate(Calendar.getInstance().getTime());
        } else if ("30 ngày qua".equals(selectedRange)) {
            calendar.add(Calendar.DATE, -29);
            ngaybatdau.setDate(calendar.getTime());
            ngayketthuc.setDate(Calendar.getInstance().getTime());
        } else if ("Tháng trước".equals(selectedRange)) {
            calendar.add(Calendar.MONTH, -1);
            calendar.set(Calendar.DAY_OF_MONTH, 1);
            ngaybatdau.setDate(calendar.getTime());
            calendar.set(Calendar.DAY_OF_MONTH, calendar.getActualMaximum(Calendar.DAY_OF_MONTH));
            ngayketthuc.setDate(calendar.getTime());
        } else if ("Tháng này".equals(selectedRange)) {
            calendar.set(Calendar.DAY_OF_MONTH, 1);
            ngaybatdau.setDate(calendar.getTime());
            calendar.set(Calendar.DAY_OF_MONTH, calendar.getActualMaximum(Calendar.DAY_OF_MONTH));
            ngayketthuc.setDate(calendar.getTime());
        } else if ("Năm trước".equals(selectedRange)) {
            calendar.add(Calendar.YEAR, -1);
            calendar.set(Calendar.MONTH, 0);
            calendar.set(Calendar.DAY_OF_MONTH, 1);
            ngaybatdau.setDate(calendar.getTime());
            calendar.set(Calendar.MONTH, 11);
            calendar.set(Calendar.DAY_OF_MONTH, 31);
            ngayketthuc.setDate(calendar.getTime());
        } else if ("Năm nay".equals(selectedRange)) {
            calendar.set(Calendar.MONTH, 0);
            calendar.set(Calendar.DAY_OF_MONTH, 1);
            ngaybatdau.setDate(calendar.getTime());
            calendar.set(Calendar.MONTH, 11);
            calendar.set(Calendar.DAY_OF_MONTH, 31);
            ngayketthuc.setDate(calendar.getTime());
        } else {
            ngaybatdau.setDate(null);
            ngayketthuc.setDate(null);
        }
    }

    private void setDefaultValues(JDateChooser ngaybatdau, JDateChooser ngayketthuc, JComboBox<String> cb) {
        // Set giá trị mặc định cho cbTopSanPham
        cb.setSelectedItem("7 ngày qua");
        Calendar calendar = Calendar.getInstance();
        // Set định dạng ngày tháng năm cho JDateChooser
        ngaybatdau.setDateFormatString("dd/MM/yyyy");
        ngayketthuc.setDateFormatString("dd/MM/yyyy");
        calendar.add(Calendar.DATE, -6);
        ngaybatdau.setDate(calendar.getTime());
        ngayketthuc.setDate(Calendar.getInstance().getTime());
    }

    private void thongKeSanPhamBanTrongKhoangThoiGian() {
        // Lấy ngày bắt đầu và kết thúc từ JDateChooser
        java.util.Date startDate = spngaybatdau.getDate();
        java.util.Date endDate = spngayketthuc.getDate();

        // Kiểm tra ngày bắt đầu và kết thúc
        if (!isValidDateRange(startDate, endDate)) {
            JOptionPane.showMessageDialog(this, "Ngày bắt đầu không được lớn hơn ngày kết thúc", "Lỗi", JOptionPane.ERROR_MESSAGE);
            return;
        }

        ArrayList<ThongKeSanPhamBanDTO> result = tkBUS.thongKeSanPhamBanTrongKhoangThoiGian(startDate, endDate);

        // Chọn số lượng dòng để hiển thị
        int selectedRowCount = getSelectedRowCount(cbTopSanPham);

        // Hiển thị số lượng dòng tương ứng trên bảng và biểu đồ
        loadDataTableSanPhamBan((DefaultTableModel) TableSanPham.getModel(), result, selectedRowCount);
        loadDataChartSanPhamBan(result, selectedRowCount);
    }

    private void thongKeTheLoaiBanTrongKhoangThoiGian() {
        // Lấy ngày bắt đầu và kết thúc từ JDateChooser
        java.util.Date startDate = tlngaybatdau.getDate();
        java.util.Date endDate = tlngayketthuc.getDate();

        // Kiểm tra ngày bắt đầu và kết thúc
        if (!isValidDateRange(startDate, endDate)) {
            JOptionPane.showMessageDialog(this, "Ngày bắt đầu không được lớn hơn ngày kết thúc", "Lỗi", JOptionPane.ERROR_MESSAGE);
            return;
        }

        ArrayList<ThongKeTheLoaiBanDTO> result = tkBUS.thongKeTheLoaiTrongKhoangThoiGian(startDate, endDate);

        // Chọn số lượng dòng để hiển thị
        int selectedRowCount = getSelectedRowCount(cbTopTheLoai);

        // Hiển thị số lượng dòng tương ứng trên bảng và biểu đồ
        loadDataTableTheLoaiBan((DefaultTableModel) TableTheLoai.getModel(), result, selectedRowCount);
        loadDataChartTheLoaiBan(result, selectedRowCount);
    }

    // Phương thức kiểm tra ngày bắt đầu và kết thúc
    private boolean isValidDateRange(java.util.Date startDate, java.util.Date endDate) {
        return startDate == null || endDate == null || !startDate.after(endDate);
    }

    private boolean isValidYearRange(int namBatDau, int namKetThuc) {
        if (namBatDau > namKetThuc) {
            JOptionPane.showMessageDialog(this, "Năm bắt đầu không được lớn hơn năm kết thúc", "Lỗi", JOptionPane.ERROR_MESSAGE);
            return false;
        }
        return true;
    }

    private void loadDataChartSanPhamBan(ArrayList<ThongKeSanPhamBanDTO> list, int number) {
        jPanelChartSanPhamBan.removeAll();
        chart = new Chart();
        chart.addLegend("Số lượng sản phẩm", new Color(245, 189, 135));
        chart.addLegend("Số lượng đơn", new Color(135, 189, 245));
        int count = 0;
        for (ThongKeSanPhamBanDTO i : list) {
            chart.addData(new ModelChart(sharedFunction.FormatID("SP", Integer.parseInt(i.getMaSP())), new double[]{i.getSoLuong(), i.getSoLuongDon()}));
            count++;
            if (count == number) {
                break;
            }
        }
        chart.repaint();
        chart.validate();
        jPanelChartSanPhamBan.add(chart);
        jPanelChartSanPhamBan.repaint();
        jPanelChartSanPhamBan.validate();
    }

    private void loadDataChartTheLoaiBan(ArrayList<ThongKeTheLoaiBanDTO> list, int number) {
        jPanelChartTheLoai.removeAll();
        chart = new Chart();
        chart.addLegend("Số lượng", new Color(189, 135, 245));
        chart.addLegend("Số loại sản phẩm", new Color(245, 189, 135));
        chart.addLegend("Số lượng đơn", new Color(135, 189, 245));
        int count = 0;
        for (ThongKeTheLoaiBanDTO i : list) {
            chart.addData(new ModelChart(sharedFunction.FormatID("TL", Integer.parseInt(i.getMaTL())), new double[]{i.getSoLuong(), i.getSoLoaiSP(), i.getSoLuongDon()}));
            count++;
            if (count == number) {
                break;
            }
        }
        chart.repaint();
        chart.validate();
        jPanelChartTheLoai.add(chart);
        jPanelChartTheLoai.repaint();
        jPanelChartTheLoai.validate();
    }

    private int getSelectedRowCount(JComboBox<String> cb) {
        // Lấy giá trị được chọn từ JComboBox
        String selectedOption = (String) cb.getSelectedItem();

        // Xử lý dựa trên giá trị được chọn
        return switch (selectedOption) {
            case "Tất cả" ->
                Integer.MAX_VALUE;
            case "Top 3" ->
                3;
            case "Top 5" ->
                5;
            case "Top 10" ->
                10;
            case "Top 20" ->
                20;
            default ->
                0;
        }; // Hiển thị tất cả dòng
    }

    // In pdf
    private ArrayList<ThongKeDoanhThuDTO> getDataFromTableTheoNam() {
        ArrayList<ThongKeDoanhThuDTO> list = new ArrayList<>();
        DefaultTableModel tableModel = (DefaultTableModel) tableTheoNam.getModel();
        for (int row = 0; row < tableModel.getRowCount(); row++) {
            String Nam = (String) tableModel.getValueAt(row, 0);
            String VonVND = (String) tableModel.getValueAt(row, 1);
            String DoanhThuVND = (String) tableModel.getValueAt(row, 2);
            String LoiNhuanVND = (String) tableModel.getValueAt(row, 3);

            long von = sharedFunction.parseVNDString(VonVND);
            long doanhThu = sharedFunction.parseVNDString(DoanhThuVND);
            long loiNhuan = sharedFunction.parseVNDString(LoiNhuanVND);
            ThongKeDoanhThuDTO item = new ThongKeDoanhThuDTO(Nam, von, doanhThu, loiNhuan);

            list.add(item);
        }

        return list;
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox<String> CbThoiGianSanPham;
    private javax.swing.JComboBox<String> CbThoiGianTheLoai;
    private javax.swing.JComboBox<String> CbTieuChi;
    private javax.swing.JComboBox<String> CbTieuChiTheLoai;
    private com.toedter.calendar.JDateChooser NgayBatDau;
    private com.toedter.calendar.JDateChooser NgayKetThuc;
    private javax.swing.JPanel PanelThongKeTheoNam;
    private javax.swing.JPanel PanelThongKeTheoThang;
    private javax.swing.JPanel PanelThongKeTheoThang1;
    private javax.swing.JPanel PanelThongKeTheoThang2;
    private javax.swing.JTable TableSanPham;
    private javax.swing.JTable TableTheLoai;
    private javax.swing.JTable TableThoiGian;
    private javax.swing.JTable TableTuNgayDenNgay;
    private javax.swing.JPanel ThongKeTheoNam;
    private javax.swing.JPanel ThongKeTheoNgayTrongThang;
    private javax.swing.JPanel ThongKeTheoThangTrongNam;
    private javax.swing.JPanel ThongKeTuNgayDenNgay;
    private Components.ButtonRadius btnInPDF;
    private Components.ButtonRadius btnThem;
    private Components.ButtonRadius btnThem1;
    private Components.ButtonRadius btnThem13;
    private Components.ButtonRadius btnThem14;
    private Components.ButtonRadius btnThem18;
    private Components.ButtonRadius btnThem19;
    private Components.ButtonRadius btnThem2;
    private Components.ButtonRadius btnThem3;
    private Components.ButtonRadius btnThem5;
    private Components.ButtonRadius btnThem6;
    private Components.ButtonRadius btnThem7;
    private Components.ButtonRadius btnThem8;
    private Components.ButtonRadius btnThongKe1;
    private Components.ButtonRadius btnXuatExcel;
    private javax.swing.JComboBox<String> cbNam;
    private javax.swing.JComboBox<String> cbNam1;
    private javax.swing.JComboBox<String> cbNamBatDau;
    private javax.swing.JComboBox<String> cbNamKetThuc;
    private javax.swing.JComboBox<String> cbThang;
    private javax.swing.JComboBox<String> cbTopSanPham;
    private javax.swing.JComboBox<String> cbTopTheLoai;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JPanel jPanelChartNam;
    private javax.swing.JPanel jPanelChartNgay;
    private javax.swing.JPanel jPanelChartSanPhamBan;
    private javax.swing.JPanel jPanelChartThang;
    private javax.swing.JPanel jPanelChartTheLoai;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JScrollPane jScrollPane9;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTabbedPane jTabbedPaneTheLoai;
    private javax.swing.JTabbedPane jTabbedPanel;
    private javax.swing.JLabel lblNam;
    private javax.swing.JLabel lblNam1;
    private javax.swing.JLabel lblNam2;
    private javax.swing.JLabel lblNam3;
    private javax.swing.JLabel lblNamBatDau;
    private javax.swing.JLabel lblNamKetThuc;
    private javax.swing.JLabel lblNamKetThuc2;
    private javax.swing.JLabel lblThoiGian;
    private javax.swing.JLabel lblThoiGian2;
    private com.toedter.calendar.JDateChooser spngaybatdau;
    private com.toedter.calendar.JDateChooser spngayketthuc;
    private javax.swing.JTable tableTheoNam;
    private javax.swing.JTable tableTheoThang;
    private javax.swing.JTable tableTheoTungNgayTrongThang;
    private com.toedter.calendar.JDateChooser tlngaybatdau;
    private com.toedter.calendar.JDateChooser tlngayketthuc;
    // End of variables declaration//GEN-END:variables
}
